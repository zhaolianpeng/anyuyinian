# 接口测试脚本总览

## 测试脚本目录

本目录包含了所有接口的独立测试脚本，按功能模块分类：

### 1. 用户认证相关
- [微信登录测试](./test_wx_login.sh) - 测试微信小程序登录接口

### 2. 首页相关
- [首页初始化测试](./test_home_init.sh) - 测试首页数据初始化接口

### 3. 文件管理
- [文件上传测试](./test_upload.sh) - 测试文件上传和文件列表接口

### 4. 系统配置
- [平台配置测试](./test_config.sh) - 测试平台配置获取接口

### 5. 用户管理
- [用户信息测试](./test_user_info.sh) - 测试用户信息和手机绑定接口
- [用户地址测试](./test_user_address.sh) - 测试用户地址管理CRUD接口
- [用户就诊人测试](./test_user_patient.sh) - 测试用户就诊人管理CRUD接口

### 6. 服务管理
- [服务相关测试](./test_service.sh) - 测试服务列表、详情、表单配置接口

### 7. 订单管理
- [订单相关测试](./test_order.sh) - 测试订单提交、支付、取消、退款等接口

### 8. 推荐系统
- [推荐系统测试](./test_referral.sh) - 测试推广二维码、佣金管理、提现等接口

### 9. 客服医院
- [客服医院测试](./test_kefu_hospital.sh) - 测试客服咨询、FAQ、医院管理等接口

## 测试脚本统计

| 模块 | 测试脚本数量 | 测试接口数量 |
|------|-------------|-------------|
| 用户认证 | 1个 | 1个 |
| 首页相关 | 1个 | 1个 |
| 文件管理 | 1个 | 2个 |
| 系统配置 | 1个 | 1个 |
| 用户管理 | 3个 | 6个 |
| 服务管理 | 1个 | 3个 |
| 订单管理 | 1个 | 6个 |
| 推荐系统 | 1个 | 4个 |
| 客服医院 | 1个 | 4个 |
| **总计** | **10个** | **28个** |

## 使用方法

### 1. 给测试脚本添加执行权限

```bash
# 给所有测试脚本添加执行权限
chmod +x tests/*.sh
```

### 2. 运行单个测试脚本

```bash
# 测试微信登录
./tests/test_wx_login.sh

# 测试首页初始化
./tests/test_home_init.sh

# 测试文件上传
./tests/test_upload.sh

# 测试用户信息
./tests/test_user_info.sh

# 测试用户地址管理
./tests/test_user_address.sh

# 测试用户就诊人管理
./tests/test_user_patient.sh

# 测试服务相关接口
./tests/test_service.sh

# 测试订单相关接口
./tests/test_order.sh

# 测试推荐系统接口
./tests/test_referral.sh

# 测试客服医院接口
./tests/test_kefu_hospital.sh
```

### 3. 运行所有测试脚本

```bash
# 运行所有测试脚本
for script in tests/*.sh; do
    echo "运行测试脚本: $script"
    ./$script
    echo "----------------------------------------"
done
```

## 测试环境要求

### 1. 服务器环境
- Go服务已启动并运行在 `localhost:80`
- 数据库已创建并导入了表结构
- 相关表已插入了测试数据

### 2. 系统要求
- Linux/macOS系统
- 安装了curl命令
- 有执行shell脚本的权限

### 3. 数据库准备
确保以下表已创建并包含测试数据：
- Users（用户表）
- Banners（轮播图表）
- Navigations（导航表）
- Services（服务表）
- Hospitals（医院表）
- Files（文件表）
- Configs（配置表）
- UserAddresses（用户地址表）
- Patients（就诊人表）
- ServiceItems（服务项目表）
- Orders（订单表）
- Referrals（推荐关系表）
- Commissions（佣金记录表）
- Cashouts（提现记录表）
- KefuMessages（客服消息表）
- Faqs（常见问题表）

## 测试数据说明

### 1. 模拟数据
- 测试脚本中使用的用户ID、服务ID等都是模拟数据
- 实际使用时需要替换为真实的数据ID

### 2. 微信登录测试
- 测试脚本中的code是模拟的
- 实际使用时需要从小程序获取真实的code

### 3. 文件上传测试
- 测试脚本会创建临时文件进行上传测试
- 测试完成后会自动清理临时文件

## 注意事项

1. **测试顺序**: 建议按照依赖关系顺序运行测试脚本
2. **数据清理**: 测试完成后可能需要清理测试数据
3. **错误处理**: 测试脚本包含基本的错误提示
4. **环境配置**: 确保测试环境配置正确
5. **权限设置**: 确保uploads目录有写入权限
6. **网络连接**: 确保服务器可以正常访问

## 故障排除

### 常见问题

1. **权限错误**: 确保测试脚本有执行权限
2. **连接失败**: 检查服务器是否正常运行
3. **数据错误**: 确保数据库表结构和数据正确
4. **文件权限**: 确保uploads目录有写入权限

### 调试方法

1. 检查服务器日志
2. 验证数据库连接
3. 确认接口路径正确
4. 检查请求参数格式 